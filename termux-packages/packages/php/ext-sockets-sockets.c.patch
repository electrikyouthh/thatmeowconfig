diff -u -r ../php-7.2.1/ext/sockets/sockets.c ./ext/sockets/sockets.c
--- ../php-7.2.1/ext/sockets/sockets.c	2018-01-02 23:36:00.000000000 +0100
+++ ./ext/sockets/sockets.c	2018-01-08 16:39:57.150438080 +0100
@@ -796,7 +796,7 @@
 	REGISTER_LONG_CONSTANT("AI_ALL",			AI_ALL,				CONST_CS | CONST_PERSISTENT);
 #endif
 	REGISTER_LONG_CONSTANT("AI_ADDRCONFIG",		AI_ADDRCONFIG,		CONST_CS | CONST_PERSISTENT);
-#ifdef __USE_GNU
+#if defined(__USE_GNU) && !defined(__ANDROID__)
 	REGISTER_LONG_CONSTANT("AI_IDN",			AI_IDN,				CONST_CS | CONST_PERSISTENT);
 	REGISTER_LONG_CONSTANT("AI_CANONIDN",		AI_CANONIDN,		CONST_CS | CONST_PERSISTENT);
 	REGISTER_LONG_CONSTANT("AI_IDN_ALLOW_UNASSIGNED",		AI_IDN_ALLOW_UNASSIGNED, CONST_CS | CONST_PERSISTENT);
